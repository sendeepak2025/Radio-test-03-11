# ğŸ—ï¸ Reporting Module Architecture Diagram

## Complete System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           USER BROWSER                                   â”‚
â”‚                                                                          â”‚
â”‚  URL: /reporting?studyUID=xxx&patientID=xxx&modality=CT                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ReportingPage.tsx                                â”‚
â”‚                         (Orchestrator)                                   â”‚
â”‚                                                                          â”‚
â”‚  â€¢ Loads URL parameters                                                 â”‚
â”‚  â€¢ Fetches existing report OR prepares new report                       â”‚
â”‚  â€¢ Shows template selector for new reports                              â”‚
â”‚  â€¢ Wraps editor in ReportingProvider                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ReportingContext.tsx                                â”‚
â”‚                   (Centralized State Management)                         â”‚
â”‚                                                                          â”‚
â”‚  STATE:                                                                  â”‚
â”‚  â”œâ”€â”€ reportId, studyInstanceUID, patientInfo                           â”‚
â”‚  â”œâ”€â”€ sections, findings, anatomicalMarkings, keyImages                 â”‚
â”‚  â”œâ”€â”€ clinicalHistory, technique, findingsText, impression              â”‚
â”‚  â”œâ”€â”€ workflowStep, creationMode, activePanel                           â”‚
â”‚  â”œâ”€â”€ hasUnsavedChanges, lastSaved, version                             â”‚
â”‚  â””â”€â”€ loading, saving, error                                            â”‚
â”‚                                                                          â”‚
â”‚  ACTIONS:                                                                â”‚
â”‚  â”œâ”€â”€ saveReport() - Auto-save every 30s                                â”‚
â”‚  â”œâ”€â”€ signReport()                                                       â”‚
â”‚  â”œâ”€â”€ addFinding(), updateFinding(), deleteFinding()                    â”‚
â”‚  â”œâ”€â”€ addMarking(), deleteMarking()                                     â”‚
â”‚  â”œâ”€â”€ updateField(), updateSection()                                    â”‚
â”‚  â””â”€â”€ setActivePanel()                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    UnifiedReportEditor.tsx                               â”‚
â”‚                     (Single Editor Component)                            â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        TOP BAR                                   â”‚  â”‚
â”‚  â”‚  Patient Info | Status | Save Button | Sign Button | Close      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   LEFT: Content Panel    â”‚   RIGHT: Feature Panels (Tabs)       â”‚  â”‚
â”‚  â”‚   (60% width)            â”‚   (40% width)                        â”‚  â”‚
â”‚  â”‚                          â”‚                                       â”‚  â”‚
â”‚  â”‚  ReportContentPanel      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚                          â”‚  â”‚  Tab Bar:                        â”‚ â”‚  â”‚
â”‚  â”‚  â€¢ Clinical History      â”‚  â”‚  [ğŸ“ Anatomical] [ğŸ¤ Voice]     â”‚ â”‚  â”‚
â”‚  â”‚  â€¢ Technique             â”‚  â”‚  [ğŸ¤– AI] [ğŸ“¥ Export]            â”‚ â”‚  â”‚
â”‚  â”‚  â€¢ Structured Findings   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚  â€¢ Findings Text         â”‚                                       â”‚  â”‚
â”‚  â”‚  â€¢ Impression            â”‚  Active Panel Content:                â”‚  â”‚
â”‚  â”‚  â€¢ Recommendations       â”‚  â”œâ”€â”€ AnatomicalDiagramPanel          â”‚  â”‚
â”‚  â”‚  â€¢ Template Sections     â”‚  â”œâ”€â”€ VoiceDictationPanel             â”‚  â”‚
â”‚  â”‚                          â”‚  â”œâ”€â”€ AIAssistantPanel                â”‚  â”‚
â”‚  â”‚                          â”‚  â””â”€â”€ ExportPanel                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Feature Panels Detail

### ğŸ“ AnatomicalDiagramPanel

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Anatomical Diagram Panel                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Body Part: [Chest â–¼]                                       â”‚
â”‚  View: [Frontal] [Lateral] [Axial]                         â”‚
â”‚                                                              â”‚
â”‚  Tools: [ğŸ“ Point] [â­• Circle] [â¡ï¸ Arrow] [âœï¸ Freehand]    â”‚
â”‚  Colors: [ğŸ”´] [ğŸŸ¢] [ğŸ”µ] [ğŸŸ¡] [ğŸŸ£]                          â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚              CANVAS (Body Diagram)                      â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â€¢ Click to mark points                                â”‚ â”‚
â”‚  â”‚  â€¢ Draw circles/arrows                                 â”‚ â”‚
â”‚  â”‚  â€¢ Freehand outline                                    â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  Markings (3):                                              â”‚
â”‚  â”œâ”€â”€ ğŸ“ Right upper lobe - frontal view [Delete]           â”‚
â”‚  â”œâ”€â”€ â­• Left lower lobe - frontal view [Delete]            â”‚
â”‚  â””â”€â”€ â¡ï¸ Mediastinum - lateral view [Delete]               â”‚
â”‚                                                              â”‚
â”‚  [Refresh Canvas]                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ¤ VoiceDictationPanel

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Voice Dictation Panel                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Dictate to: [Findings â–¼]                                  â”‚
â”‚                                                              â”‚
â”‚  Status: ğŸ”´ Listening...                                    â”‚
â”‚                                                              â”‚
â”‚  [â¸ï¸ Pause] [â¹ï¸ Stop]                                       â”‚
â”‚                                                              â”‚
â”‚  Live Transcript:                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ "The lungs are clear bilaterally. No consolidation    â”‚ â”‚
â”‚  â”‚  or infiltrate. No pleural effusion..."               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  ğŸ’¡ Tips:                                                   â”‚
â”‚  â€¢ Say "period" for punctuation                            â”‚
â”‚  â€¢ Say "new line" for breaks                               â”‚
â”‚  â€¢ Speak clearly at normal pace                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ¤– AIAssistantPanel

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI Assistant Panel                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  AI Analysis: âœ… Available                                  â”‚
â”‚  Analysis ID: ai-123...                                     â”‚
â”‚                                                              â”‚
â”‚  [ğŸ”„ Refresh AI] [âœ… Apply All]                            â”‚
â”‚                                                              â”‚
â”‚  AI Suggestions (3 pending):                                â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [finding] Lung nodule detected                         â”‚ â”‚
â”‚  â”‚ Right upper lobe, 8mm nodule (Confidence: 92%)        â”‚ â”‚
â”‚  â”‚                                          [+ Add]       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [impression] No acute findings                         â”‚ â”‚
â”‚  â”‚ Lungs clear, heart normal size (Confidence: 95%)      â”‚ â”‚
â”‚  â”‚                                          [+ Add]       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  ğŸ’¡ AI is assistive, not diagnostic                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“¥ ExportPanel

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Export Panel                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Report Status: DRAFT                                       â”‚
â”‚  âš ï¸ Consider signing before exporting                       â”‚
â”‚                                                              â”‚
â”‚  Select Format:                                             â”‚
â”‚                                                              â”‚
â”‚  âšª ğŸ“„ PDF Report                                           â”‚
â”‚     Professional document with letterhead                   â”‚
â”‚                                                              â”‚
â”‚  âšª ğŸ“ Plain Text                                           â”‚
â”‚     Simple text format for copying                          â”‚
â”‚                                                              â”‚
â”‚  âšª ğŸ’¾ JSON                                                 â”‚
â”‚     Structured data format                                  â”‚
â”‚                                                              â”‚
â”‚  âšª ğŸ¥ DICOM SR                                             â”‚
â”‚     DICOM Structured Report                                 â”‚
â”‚                                                              â”‚
â”‚  âšª ğŸ”— FHIR Bundle                                          â”‚
â”‚     HL7 FHIR DiagnosticReport                              â”‚
â”‚                                                              â”‚
â”‚  [ğŸ“¥ Export Report]                                         â”‚
â”‚                                                              â”‚
â”‚  ğŸ“„ Export Information:                                     â”‚
â”‚  â€¢ PDF: Best for printing                                  â”‚
â”‚  â€¢ DICOM SR: For PACS                                      â”‚
â”‚  â€¢ FHIR: For EHR/EMR                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow

### 1. User Interaction â†’ Action

```
User clicks "Add Finding"
        â†“
Component calls: actions.addFinding(finding)
        â†“
ReportingContext dispatches: { type: 'ADD_FINDING', payload: finding }
        â†“
Reducer updates state: state.findings = [...state.findings, finding]
        â†“
State change triggers re-render
        â†“
Component displays updated findings list
```

### 2. Auto-Save Flow

```
User types in field
        â†“
Component calls: actions.updateField('impression', value)
        â†“
Reducer sets: hasUnsavedChanges = true
        â†“
useEffect detects unsaved changes
        â†“
Timer starts (30 seconds)
        â†“
Timer expires
        â†“
actions.saveReport() called
        â†“
API: PUT /api/reports/:reportId
        â†“
Success: hasUnsavedChanges = false, lastSaved = now
```

### 3. Anatomical Marking Flow

```
User draws on canvas
        â†“
handleMouseUp() creates marking object
        â†“
actions.addMarking(marking)
        â†“
Reducer adds to state.anatomicalMarkings
        â†“
Auto-create linked finding
        â†“
actions.addFinding(linkedFinding)
        â†“
Both marking and finding saved together
        â†“
Canvas redraws with new marking
```

---

## Component Hierarchy

```
App
â””â”€â”€ Router
    â””â”€â”€ ReportingPage
        â”œâ”€â”€ TemplateSelector (if new report)
        â”‚   â””â”€â”€ Template cards
        â”‚
        â””â”€â”€ ReportingProvider
            â””â”€â”€ UnifiedReportEditor
                â”œâ”€â”€ TopBar
                â”‚   â”œâ”€â”€ PatientInfo
                â”‚   â”œâ”€â”€ StatusChips
                â”‚   â”œâ”€â”€ SaveButton
                â”‚   â”œâ”€â”€ SignButton
                â”‚   â””â”€â”€ CloseButton
                â”‚
                â”œâ”€â”€ LeftPanel
                â”‚   â””â”€â”€ ReportContentPanel
                â”‚       â”œâ”€â”€ ClinicalHistoryField
                â”‚       â”œâ”€â”€ TechniqueField
                â”‚       â”œâ”€â”€ StructuredFindingsList
                â”‚       â”œâ”€â”€ FindingsTextField
                â”‚       â”œâ”€â”€ ImpressionField
                â”‚       â”œâ”€â”€ RecommendationsField
                â”‚       â””â”€â”€ TemplateSections
                â”‚
                â””â”€â”€ RightPanel
                    â”œâ”€â”€ TabBar
                    â”‚   â”œâ”€â”€ AnatomicalTab
                    â”‚   â”œâ”€â”€ VoiceTab
                    â”‚   â”œâ”€â”€ AITab
                    â”‚   â””â”€â”€ ExportTab
                    â”‚
                    â””â”€â”€ ActivePanel
                        â”œâ”€â”€ AnatomicalDiagramPanel
                        â”‚   â”œâ”€â”€ BodyPartSelector
                        â”‚   â”œâ”€â”€ ViewSelector
                        â”‚   â”œâ”€â”€ DrawingTools
                        â”‚   â”œâ”€â”€ Canvas
                        â”‚   â””â”€â”€ MarkingsList
                        â”‚
                        â”œâ”€â”€ VoiceDictationPanel
                        â”‚   â”œâ”€â”€ FieldSelector
                        â”‚   â”œâ”€â”€ Controls
                        â”‚   â””â”€â”€ Transcript
                        â”‚
                        â”œâ”€â”€ AIAssistantPanel
                        â”‚   â”œâ”€â”€ StatusCard
                        â”‚   â”œâ”€â”€ RefreshButton
                        â”‚   â””â”€â”€ SuggestionsList
                        â”‚
                        â””â”€â”€ ExportPanel
                            â”œâ”€â”€ StatusCard
                            â”œâ”€â”€ FormatSelector
                            â””â”€â”€ ExportButton
```

---

## State Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INITIAL STATE                             â”‚
â”‚  â€¢ reportId: undefined                                       â”‚
â”‚  â€¢ findings: []                                              â”‚
â”‚  â€¢ anatomicalMarkings: []                                    â”‚
â”‚  â€¢ hasUnsavedChanges: false                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              USER ADDS FINDING                               â”‚
â”‚  dispatch({ type: 'ADD_FINDING', payload: finding })        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 REDUCER UPDATES                              â”‚
â”‚  â€¢ findings: [...findings, newFinding]                      â”‚
â”‚  â€¢ hasUnsavedChanges: true                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COMPONENTS RE-RENDER                            â”‚
â”‚  â€¢ ReportContentPanel shows new finding                     â”‚
â”‚  â€¢ TopBar shows "Unsaved changes" chip                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AUTO-SAVE TIMER (30s)                           â”‚
â”‚  useEffect detects hasUnsavedChanges = true                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 SAVE TO API                                  â”‚
â”‚  PUT /api/reports/:reportId                                  â”‚
â”‚  Body: { findings, anatomicalMarkings, ... }                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SUCCESS RESPONSE                                â”‚
â”‚  â€¢ hasUnsavedChanges: false                                  â”‚
â”‚  â€¢ lastSaved: new Date()                                     â”‚
â”‚  â€¢ version: version + 1                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FRONTEND                                  â”‚
â”‚              (ReportingContext)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ HTTP Requests
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND API                               â”‚
â”‚              /api/reports/*                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  GET    /api/reports/:reportId                              â”‚
â”‚         â†’ Load existing report                              â”‚
â”‚                                                              â”‚
â”‚  PUT    /api/reports/:reportId                              â”‚
â”‚         â†’ Save report (auto-save or manual)                 â”‚
â”‚                                                              â”‚
â”‚  POST   /api/reports/:reportId/sign                         â”‚
â”‚         â†’ Sign report (finalize)                            â”‚
â”‚                                                              â”‚
â”‚  GET    /api/reports/:reportId/pdf                          â”‚
â”‚         â†’ Export as PDF                                     â”‚
â”‚                                                              â”‚
â”‚  GET    /api/reports/:reportId/export/dicom-sr              â”‚
â”‚         â†’ Export as DICOM SR                                â”‚
â”‚                                                              â”‚
â”‚  GET    /api/reports/:reportId/export/fhir                  â”‚
â”‚         â†’ Export as FHIR                                    â”‚
â”‚                                                              â”‚
â”‚  GET    /api/reports/templates                              â”‚
â”‚         â†’ Get available templates                           â”‚
â”‚                                                              â”‚
â”‚  POST   /api/reports                                        â”‚
â”‚         â†’ Create new report from template                   â”‚
â”‚                                                              â”‚
â”‚  GET    /api/ai-analysis/:analysisId                        â”‚
â”‚         â†’ Load AI analysis data                             â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATABASE                                  â”‚
â”‚                  (MongoDB)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  StructuredReport Collection:                               â”‚
â”‚  {                                                           â”‚
â”‚    reportId: "RPT-123",                                     â”‚
â”‚    studyInstanceUID: "1.2.3.4.5",                           â”‚
â”‚    patientInfo: { ... },                                    â”‚
â”‚    sections: { ... },                                       â”‚
â”‚    findings: [ ... ],                                       â”‚
â”‚    anatomicalMarkings: [ ... ],                             â”‚
â”‚    keyImages: [ ... ],                                      â”‚
â”‚    version: 3,                                              â”‚
â”‚    reportStatus: "draft",                                   â”‚
â”‚    createdAt: Date,                                         â”‚
â”‚    updatedAt: Date                                          â”‚
â”‚  }                                                           â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Summary

This architecture provides:

âœ… **Clean Separation**: Each component has one clear responsibility
âœ… **Centralized State**: Single source of truth in ReportingContext
âœ… **Scalable**: Easy to add new feature panels
âœ… **Maintainable**: Clear data flow and component hierarchy
âœ… **Performant**: Optimized re-renders, auto-save, lazy loading
âœ… **Type-Safe**: Full TypeScript coverage
âœ… **Testable**: Each component can be tested independently

**Result**: A production-ready, maintainable, and feature-rich reporting system! ğŸ‰
